/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
 
 buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath "com.bmuschko:gradle-tomcat-plugin:2.5"
    }
}

 plugins {
    id 'war'
    id 'java'
    id 'org.akhikhl.gretty' version '1.4.2'
 }
	
 gretty {
    servletContainer = 'tomcat8'
}

task stage {
    dependsOn clean, war
}
war.mustRunAfter clean

task copyToLib(type: Copy) {
    into "$buildDir/server"
    from(configurations.compile) {
        include "webapp-runner*"
    }
}

stage.dependsOn(copyToLib)

dependencies {
    providedCompile 'com.bmuschko:gradle-tomcat-plugin:2.5'
    compile 'com.github.jsimone:webapp-runner:8.5.11.3'
    providedCompile 'javax.servlet:javax.servlet-api:3.1.0'
    providedCompile group: 'javax.enterprise', name: 'cdi-api', version: '1.1.EDR1'
    providedCompile group: 'javax.websocket', name: 'javax.websocket-api', version: '1.1'
    providedCompile group: 'com.bmuschko', name: 'gradle-tomcat-plugin', version: '2.5'
}

repositories {
    jcenter()
    mavenCentral()
}