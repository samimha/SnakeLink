/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
 
buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath "com.bmuschko:gradle-tomcat-plugin:2.5"
    }
}

plugins {
    id 'war'
    id 'java'
    id 'org.akhikhl.gretty' version '1.4.2'
}

dependencies {
    providedCompile 'com.bmuschko:gradle-tomcat-plugin:2.5'
    compile 'com.github.jsimone:webapp-runner:8.5.30.0'
    providedCompile 'javax.servlet:javax.servlet-api:3.1.0'
    providedCompile group: 'javax.enterprise', name: 'cdi-api', version: '1.1.EDR1'
    providedCompile group: 'javax.websocket', name: 'javax.websocket-api', version: '1.1'
    providedCompile group: 'com.bmuschko', name: 'gradle-tomcat-plugin', version: '2.5'
}

gretty {
    servletContainer = 'tomcat8'
}

task copyToLib(type: Copy) {
    into "$buildDir/libs"
    from(configurations.compile) {
        include "webapp-runner*"
    }
}

task stage {
    dependsOn clean, war, copyToLib
}
war.mustRunAfter clean

repositories {
    jcenter()
    mavenCentral()
}