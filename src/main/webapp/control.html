<!DOCTYPE html>
<html>

<head>
    <title>Controller</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="grid-container">
        <div class="grid-item up">
            <button id="up">^</button>
        </div>
        <div class="grid-item left">
            <button id="left">
                <</button>
        </div>
        <div class="grid-item center"></div>
        <div class="grid-item right">
            <button id="right">></button>
        </div>
        <div class="grid-item down">
            <button id="down">v</button>
        </div>
        <div class="grid-item item">
            <h3>Hit</h3>
            <p id="hit"></p>

        </div>
    </div>
    <script>
        document.addEventListener("DOMContentLoaded", function (event) {
            const up = document.querySelector("#up");
            const down = document.querySelector("#down");
            const left = document.querySelector("#left");
            const right = document.querySelector("#right");
            const hit = document.querySelector("#hit");
            let id;
            let url = document.location.href.split("/");
            url[4] = "actions";
            let wsUrl = url[2] + "/" + url[3] + "/" + url[4];
            console.log(wsUrl);
            const socket = new WebSocket("ws:" + wsUrl);
            socket.addEventListener("message", function (e) {
                id = e.data;
            })


            down.addEventListener('click', function (e) {
                //hit.textContent = "down";
                socket.send(id + "-down");
            });
            //yl√∂s
            up.addEventListener('click', function (e) {
                //hit.textContent = "up";
                socket.send(id + "-up");
            });
            //oikea
            right.addEventListener('click', function (e) {
                //hit.textContent = "right";
                socket.send(id + "-right");
            });
            //vasen
            left.addEventListener('click', function (e) {
                //hit.textContent = "left";
                socket.send(id + "-left");
            });
            window.addEventListener("keydown", function (event) {
                if (event.defaultPrevented) {
                    return; // Do nothing if the event was already processed
                }

                switch (event.key) {
                    case "ArrowDown":
                        socket.send(id + "-down");
                        break;
                    case "ArrowUp":
                        socket.send(id + "-up");
                        break;
                    case "ArrowLeft":
                        socket.send(id + "-left");
                        break;
                    case "ArrowRight":
                        socket.send(id + "-right");
                        break;
                    default:
                        return; // Quit when this doesn't handle the key event.
                }

                // Cancel the default action to avoid it being handled twice
                event.preventDefault();
            }, true);
        });
    </script>
</body>

</html>